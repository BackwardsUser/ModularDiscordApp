<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/main.styles.css">
    <title>main</title>
</head>
<header>
    <button class="account" id="account">
        <img src="" class="profilePicture" id="profilePicture">
        <a class="accountName" id="accountName"></a>
    </button>
    <div class="dropdown hidden" id="dropdown">
        <a class="logout" id="logout">Logout</a>
    </div>
    <button class="close" id="closeBtn">&times;</button>
</header>
<body>
    <br>
    <select name="BotStatus" id="botStatus" class="botStatus" >
        <option value="online">Online</option>
        <option value="dnd">DnD</option>
        <option value="idle">Away</option>
        <option value="invisible">Offline</option>
    </select><br><br><br>
    <center>
        <div class="activity" id="currentActivity">No Activity Set. Set it with the button below!</div>
    </center><br>
    <button class="button" id="activity">Set Activity</button>

</body>
<script>

    basicClientData = {};

    const { ipcRenderer } = require('electron');
    const profilePicture = document.getElementById('profilePicture');
    const accountName = document.getElementById('accountName');
    const currentActivity = document.getElementById('currentActivity');

    ipcRenderer.send('main:account:request:basicClientInfo');

    ipcRenderer.on('main:account:send:clientBasicInfo', (e, basicClientInfo) => {
        basicClientData = basicClientInfo;
        profilePicture.src = basicClientData.avatarURL;
        accountName.innerHTML = basicClientData.name;
    });

    document.getElementById('closeBtn').addEventListener('click', () => {
        ipcRenderer.send('main:close');
    });

    document.getElementById('account').addEventListener('click', () => {
        const dropdown = document.getElementById('dropdown');
        if (dropdown.className === "dropdown hidden") {
            dropdown.className = "dropdown displayed";
        } else {
            dropdown.className = "dropdown hidden";
        };
    });

    document.getElementById('logout').addEventListener('click', () => {
        ipcRenderer.send('main:account:logout');
    });

    document.getElementById('botStatus').addEventListener('change', () => {
        ipcRenderer.send('main:account:status:changed', document.getElementById('botStatus').value);
    });

    document.getElementById('activity').addEventListener('click', () => {
        ipcRenderer.send('page:open:activity');
    });

    ipcRenderer.on('main:account:send:activity', (e, activity) => {
        console.log(activity);
        currentActivity.innerText = activity.type + " " + activity.name;
    });

</script>
</html>